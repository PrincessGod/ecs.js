{"version":3,"file":"ecs.umd.js","sources":["../src/UUID.js","../src/Component.js","../src/Entity.js","../src/Group.js","../src/System.js","../src/Context.js"],"sourcesContent":["const hex = [ // hex identity values 0-255\n\t\"00\", \"01\", \"02\", \"03\", \"04\", \"05\", \"06\", \"07\", \"08\", \"09\", \"0a\", \"0b\", \"0c\", \"0d\", \"0e\", \"0f\",\n\t\"10\", \"11\", \"12\", \"13\", \"14\", \"15\", \"16\", \"17\", \"18\", \"19\", \"1a\", \"1b\", \"1c\", \"1d\", \"1e\", \"1f\",\n\t\"20\", \"21\", \"22\", \"23\", \"24\", \"25\", \"26\", \"27\", \"28\", \"29\", \"2a\", \"2b\", \"2c\", \"2d\", \"2e\", \"2f\",\n\t\"30\", \"31\", \"32\", \"33\", \"34\", \"35\", \"36\", \"37\", \"38\", \"39\", \"3a\", \"3b\", \"3c\", \"3d\", \"3e\", \"3f\",\n\t\"40\", \"41\", \"42\", \"43\", \"44\", \"45\", \"46\", \"47\", \"48\", \"49\", \"4a\", \"4b\", \"4c\", \"4d\", \"4e\", \"4f\",\n\t\"50\", \"51\", \"52\", \"53\", \"54\", \"55\", \"56\", \"57\", \"58\", \"59\", \"5a\", \"5b\", \"5c\", \"5d\", \"5e\", \"5f\",\n\t\"60\", \"61\", \"62\", \"63\", \"64\", \"65\", \"66\", \"67\", \"68\", \"69\", \"6a\", \"6b\", \"6c\", \"6d\", \"6e\", \"6f\",\n\t\"70\", \"71\", \"72\", \"73\", \"74\", \"75\", \"76\", \"77\", \"78\", \"79\", \"7a\", \"7b\", \"7c\", \"7d\", \"7e\", \"7f\",\n\t\"80\", \"81\", \"82\", \"83\", \"84\", \"85\", \"86\", \"87\", \"88\", \"89\", \"8a\", \"8b\", \"8c\", \"8d\", \"8e\", \"8f\",\n\t\"90\", \"91\", \"92\", \"93\", \"94\", \"95\", \"96\", \"97\", \"98\", \"99\", \"9a\", \"9b\", \"9c\", \"9d\", \"9e\", \"9f\",\n\t\"a0\", \"a1\", \"a2\", \"a3\", \"a4\", \"a5\", \"a6\", \"a7\", \"a8\", \"a9\", \"aa\", \"ab\", \"ac\", \"ad\", \"ae\", \"af\",\n\t\"b0\", \"b1\", \"b2\", \"b3\", \"b4\", \"b5\", \"b6\", \"b7\", \"b8\", \"b9\", \"ba\", \"bb\", \"bc\", \"bd\", \"be\", \"bf\",\n\t\"c0\", \"c1\", \"c2\", \"c3\", \"c4\", \"c5\", \"c6\", \"c7\", \"c8\", \"c9\", \"ca\", \"cb\", \"cc\", \"cd\", \"ce\", \"cf\",\n\t\"d0\", \"d1\", \"d2\", \"d3\", \"d4\", \"d5\", \"d6\", \"d7\", \"d8\", \"d9\", \"da\", \"db\", \"dc\", \"dd\", \"de\", \"df\",\n\t\"e0\", \"e1\", \"e2\", \"e3\", \"e4\", \"e5\", \"e6\", \"e7\", \"e8\", \"e9\", \"ea\", \"eb\", \"ec\", \"ed\", \"ee\", \"ef\",\n\t\"f0\", \"f1\", \"f2\", \"f3\", \"f4\", \"f5\", \"f6\", \"f7\", \"f8\", \"f9\", \"fa\", \"fb\", \"fc\", \"fd\", \"fe\", \"ff\"\n];\n\nexport class UUID {\n\n\tstatic create() {\n\n\t\tconst d0 = Math.random() * 0xffffffff | 0;\n\t\tconst d1 = Math.random() * 0xffffffff | 0;\n\t\tconst d2 = Math.random() * 0xffffffff | 0;\n\t\tconst d3 = Math.random() * 0xffffffff | 0;\n\t\treturn hex[ d0 & 0xff ] + hex[ d0 >> 8 & 0xff ] + hex[ d0 >> 16 & 0xff ] + hex[ d0 >> 24 & 0xff ] + '-' +\n          hex[ d1 & 0xff ] + hex[ d1 >> 8 & 0xff ] + '-' + hex[ d1 >> 16 & 0x0f | 0x40 ] + hex[ d1 >> 24 & 0xff ] + '-' +\n          hex[ d2 & 0x3f | 0x80 ] + hex[ d2 >> 8 & 0xff ] + '-' + hex[ d2 >> 16 & 0xff ] + hex[ d2 >> 24 & 0xff ] +\n          hex[ d3 & 0xff ] + hex[ d3 >> 8 & 0xff ] + hex[ d3 >> 16 & 0xff ] + hex[ d3 >> 24 & 0xff ];\n\n\t}\n\n\tstatic hash( str ) {\n\n\t\tlet hash = 0, i, chr;\n\t\tif ( str.length === 0 ) return hash;\n\t\tfor ( i = 0; i < str.length; i ++ ) {\n\n\t\t\tchr = str.charCodeAt( i );\n\t\t\thash = ( ( hash << 5 ) - hash ) + chr;\n\t\t\thash |= 0; // Convert to 32bit integer\n\n\t\t}\n\t\treturn hash;\n\n\t}\n\n}\n","import { UUID } from \"./UUID\";\n\nexport class Component {\n\n\t/*\n    Injected component info struct:\n    {\n        key: 'number' unique value for each type of component\n        value: 'function' constructor for component\n    }\n    */\n\tstatic getInjectedComponents() {\n\n\t\tif ( ! Component._injected )\n\t\t\tComponent._injected = new Map();\n\n\t\treturn Component._injected;\n\n\t}\n\n\t/*\n    return component unique id\n    */\n\tstatic inject( fun ) {\n\n\t\tif ( typeof fun !== 'function' )\n\t\t\treturn\tconsole.error( 'component not type of function' );\n\n\t\tconst components = Component.getInjectedComponents();\n\t\tconst key = UUID.hash( fun.name );\n\t\tif ( components.has( key ) ) {\n\n\t\t\tconsole.warn( `component ${fun} has already injected` );\n\t\t\treturn key;\n\n\t\t}\n\n\t\tObject.defineProperties( fun, {\n\n\t\t\tcomponentKey: {\n\t\t\t\tget() {\n\n\t\t\t\t\treturn key;\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t} );\n\n\t\tObject.defineProperties( fun.prototype, {\n\t\t\tuuid: {\n\t\t\t\tget() {\n\n\t\t\t\t\treturn this._uuid;\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tcomponentKey: {\n\t\t\t\tget() {\n\n\t\t\t\t\treturn key;\n\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\n\t\tcomponents.set( key, fun );\n\t\treturn key;\n\n\t}\n\n\tstatic create( com, ...args ) {\n\n\t\tconst components = Component.getInjectedComponents();\n\t\tlet Func = null;\n\n\t\tif ( typeof com === 'function' &&\n\t\t\ttypeof com.componentKey === 'number' &&\n\t\t\tcomponents.get( com.componentKey ) === com )\n\t\t\tFunc = com;\n\t\telse if ( typeof com === 'number' && components.has( com ) )\n\t\t\tFunc = components.get( com );\n\t\telse\n\t\t\treturn console.error( `unknown component info: ${com}` );\n\n\t\tconst obj = new Func( ...args );\n\t\tobj._uuid = UUID.create();\n\t\treturn obj;\n\n\t}\n\n}\n","import { UUID } from './UUID';\nimport { Component } from './Component';\n\nexport class Entity {\n\n\tconstructor() {\n\n\t\tthis._uuid = UUID.create();\n\t\tthis._com = {};\n\n\t}\n\n\tget uuid() {\n\n\t\treturn this._uuid;\n\n\t}\n\n\tget com() {\n\n\t\treturn this._com;\n\n\t}\n\n\taddComponent( com, ...args ) {\n\n\t\tlet componentName;\n\t\tif ( typeof com === 'number' )\n\t\t\tcomponentName = Component.getInjectedComponents().get( com ).name;\n\t\telse if ( typeof com === 'function' )\n\t\t\tcomponentName = com.name;\n\t\telse if ( com.componentKey ) {\n\n\t\t\tcomponentName = com.constructor.name;\n\n\t\t\tif ( this._com[ componentName ] )\n\t\t\t\tconsole.warn( `componnet type ${componentName} existed` );\n\t\t\telse\n\t\t\t\tthis._com[ componentName ] = com;\n\n\t\t\treturn this._com[ componentName ];\n\n\t\t} else\n\t\t\treturn console.error( 'wrong argument type' );\n\n\t\tif ( this._com[ componentName ] )\n\t\t\tconsole.warn( `componnet type ${componentName} existed` );\n\t\telse {\n\n\t\t\tconst component = Component.create( com, ...args );\n\t\t\tthis._com[ componentName ] = component;\n\n\t\t}\n\t\treturn this._com[ componentName ];\n\n\t}\n\n\tremoveComponent( com ) {\n\n\t\tlet componentName;\n\t\tif ( typeof com === 'number' )\n\t\t\tcomponentName = Component.getInjectedComponents().get( com ).name;\n\t\telse if ( typeof com === 'function' )\n\t\t\tcomponentName = com.name;\n\t\telse if ( com.componentKey )\n\t\t\tcomponentName = com.constructor.name;\n\t\telse\n\t\t\treturn console.error( 'argument type error' );\n\n\t\tconst component = this._com[ componentName ];\n\t\tdelete this._com[ componentName ];\n\t\treturn component;\n\n\t}\n\n\tgetComponent( com ) {\n\n\t\tlet componentName;\n\t\tif ( typeof com === 'number' )\n\t\t\tcomponentName = Component.getInjectedComponents().get( com ).name;\n\t\telse if ( typeof com === 'function' )\n\t\t\tcomponentName = com.name;\n\t\telse if ( com.componentKey ) {\n\n\t\t\tcomponentName = com.constructor.name;\n\t\t\treturn this._com[ componentName ];\n\n\t\t} else\n\t\t\treturn console.error( 'argument type error' );\n\n\t\treturn this._com[ componentName ];\n\n\t}\n\n}\n","export class Group {\n\n\tconstructor( searchString = '' ) {\n\n\t\tif ( ! searchString )\n\t\t\tthrow Error( `searchString not passed` );\n\n\t\tthis._searchString = Group.getSearchString( searchString );\n\t\tconst coms = this._searchString.split( '&' );\n\t\tthis._requiredComs = coms.filter( ( c ) => c[ 0 ] !== '!' );\n\t\tthis._disabledComs = coms.filter( ( c ) => c[ 0 ] === '!' ).map( ( c ) => c.slice( 1 ) );\n\t\tthis._entities = [];\n\n\t}\n\n\tstatic getSearchString( searchString ) {\n\n\t\tif ( typeof searchString !== 'string' || ! searchString )\n\t\t\treturn console.error( `unvalued search string ${searchString}` );\n\n\t\treturn searchString.replace( /\\s/g, '' ).split( '&' ).sort().join( '&' );\n\n\t}\n\n\tget searchString() {\n\n\t\treturn this._searchString;\n\n\t}\n\n\tget entities() {\n\n\t\treturn this._entities;\n\n\t}\n\n\taddEntity( e ) {\n\n\t\tif ( this.test( e ) && this._entities.indexOf( e ) < 0 ) {\n\n\t\t\tthis._entities.push( e );\n\t\t\treturn true;\n\n\t\t}\n\t\treturn false;\n\n\t}\n\n\tremoveEntity( e ) {\n\n\t\tconst idx = this._entities.indexOf( e );\n\t\tif ( idx > - 1 )\n\t\t\treturn this._entities.splice( idx, 1 )[ 0 ];\n\t\treturn false;\n\n\t}\n\n\ttest( e ) {\n\n\t\treturn ! this._requiredComs.filter( com => ! e.com[ com ] ).length\n            && ! this._disabledComs.filter( com => e.com[ com ] ).length;\n\n\t}\n\n}\n","export class System {\n\n\tconstructor( priority = 1, enable = true ) {\n\n\t\tthis._priority = priority;\n\t\tthis._enable = enable;\n\n\t}\n\n\tget priority() {\n\n\t\treturn this._priority;\n\n\t}\n\n\tget enable() {\n\n\t\treturn this._enable;\n\n\t}\n\n\tset enable( v ) {\n\n\t\tthis._enable = !! v;\n\n\t}\n\n\tonAddToContext( context ) { // eslint-disable-line\n\n\t}\n\n\tonRemoveFromContext( context ) { // eslint-disable-line\n\n\t}\n\n\tupdate( context ) { // eslint-disable-line\n\n\t}\n\n}\n","import { Group } from './Group';\nimport { System } from './System';\n\nexport class Context {\n\n\tconstructor() {\n\n\t\tthis._entitys = [];\n\t\tthis._groups = new Map();\n\t\tthis._systems = [];\n\n\t}\n\n\tget entitys() {\n\n\t\treturn this._entitys;\n\n\t}\n\n\tget entityCount() {\n\n\t\treturn this._entitys.length;\n\n\t}\n\n\tget systems() {\n\n\t\treturn this._systems;\n\n\t}\n\n\taddEntity( e ) {\n\n\t\tif ( this._entitys.indexOf( e ) < 0 ) {\n\n\t\t\tthis._entitys.push( e );\n\t\t\tthis._groups.forEach( ( group ) => group.addEntity( e ) );\n\n\t\t} else\n\t\t\tconsole.warn( `entity ${e} already existed` );\n\n\t\treturn this;\n\n\t}\n\n\tremoveEntity( e ) {\n\n\t\tconst idx = this._entitys.indexOf( e );\n\n\t\tif ( idx > - 1 ) {\n\n\t\t\tthis._entitys.splice( idx, 1 );\n\t\t\tthis._groups.forEach( ( group ) => group.removeEntity( e ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetGroup( searchString ) {\n\n\t\tconst key = Group.getSearchString( searchString );\n\t\tif ( this._groups.has( key ) )\n\t\t\treturn this._groups.get( key );\n\n\t\tconst group = new Group( key );\n\t\tthis._entitys.forEach( e => group.addEntity( e ) );\n\t\tthis._groups.set( key, group );\n\t\treturn group;\n\n\t}\n\n\taddSystem( s ) {\n\n\t\tif ( s instanceof System ) {\n\n\t\t\tthis._systems.push( s );\n\t\t\tthis._systems.sort( ( a, b ) => a.priority - b.priority );\n\t\t\ts.onAddToContext( this );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tremoveSystem( s ) {\n\n\t\twhile ( this._systems.indexOf( s ) > - 1 ) {\n\n\t\t\tconst idx = this._systems.indexOf( s );\n\t\t\tthis._systems.splice( idx, 1 );\n\t\t\ts.onRemoveFromContext( this );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\texecute() {\n\n\t\tthis._systems.forEach( ( s ) => s.enable && s.update( this ) );\n\t\treturn this;\n\n\t}\n\n}\n"],"names":["hex","UUID","d0","Math","random","d1","d2","d3","str","hash","i","chr","length","charCodeAt","Component","_injected","Map","fun","console","error","components","getInjectedComponents","key","name","has","warn","Object","defineProperties","componentKey","get","prototype","uuid","_uuid","set","com","Func","args","obj","create","Entity","_com","componentName","constructor","component","Group","searchString","Error","_searchString","getSearchString","coms","split","_requiredComs","filter","c","_disabledComs","map","slice","_entities","e","test","indexOf","push","idx","splice","replace","sort","join","System","priority","enable","_priority","_enable","context","v","Context","_entitys","_groups","_systems","forEach","group","addEntity","removeEntity","s","a","b","onAddToContext","onRemoveFromContext","update"],"mappings":"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"}